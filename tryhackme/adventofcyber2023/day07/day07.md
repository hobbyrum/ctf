# Day 7 
## Log analysis
### 'Tis the season for log chopping

**How many unique ip addresses are connected to the proxy server?**
9

**How many unique domains were accessed by all workstations?**
```bash
cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq | wc -l
```
111

**What status code is generated by the HTTP requests to the least accessed comain?**
```bash
cut -d ' ' -f3,6 access.log | sort | uniq -c | sort -n
      2 signup.live.com:443 503
      1 www.digicert.com:443 504
      1 powerautomate.com:443 000
```
*Why is the answer 503? It's not the domain that is least accessed*
503

**Based on the high count of connection attempts, whatis the name of the suspicious domain?**
frostlings.bigbadstash.thm

**What is the source IP of the workstation that accessed the malicious domain?**
```bash
grep frostlings.bigbadstash.thm access.log | cut -d ' ' -f2 | uniq
```
10.10.185.225

**How many requests were made on the malicious domain in total?**
```bash
cut -d ' ' -f3 access.log | cut -d ':' -f1 | sort | uniq -c | sort -n
```
1581

**Having retrieved the exfiltrated data, what is the hidden flag?**
```bash
grep frostlings.bigbadstash.thm access.log | cut -d ' ' -f5 | cut -d '=' -f2 | base64 -d | grep THM{
```
THM{a_gift_for_you_awesome_analyst!}